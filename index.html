<!DOCTYPE html>
<html>
<head>
    <title>Prayer Times Countdown</title>
    <script>
        const prayerTimes = {
            fajr: "05:24",
            dhuhr: "13:40",
            asr: "17:17",
            maghrib: "20:32",
            isha: "21:46"
        };

        function getTime(date, timeString) {
            const [hours, minutes] = timeString.split(':').map(Number);
            date.setHours(hours);
            date.setMinutes(minutes);
            date.setSeconds(0);
            return new Date(date);  // Return a new date object to avoid modifying the original date
        }

        function getNextPrayerTime(prayerTimesArray) {
            const now = new Date();
            for (let prayer of prayerTimesArray) {
                if (now < prayer.time) {
                    return prayer;
                }
            }
            return prayerTimesArray[0];
        }

        function format12Hour(date) {
            let hours = date.getHours();
            const minutes = date.getMinutes();
            const ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12;
            hours = hours ? hours : 12; // the hour '0' should be '12'
            const minutesStr = minutes < 10 ? '0' + minutes : minutes;
            return `${hours}:${minutesStr} ${ampm}`;
        }

        function startCountdown(prayer) {
            const countdownElement = document.getElementById('countdown');
            function updateCountdown() {
                const now = new Date();
                const timeDiff = prayer.time - now;
                
                if (timeDiff <= 0) {
                    clearInterval(intervalId);
                    countdownElement.innerHTML = `It's time for ${prayer.name} prayer!`;
                    return;
                }

                const hours = Math.floor(timeDiff / (1000 * 60 * 60));
                const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);

                const hoursStr = hours < 10 ? '0' + hours : hours;
                const minutesStr = minutes < 10 ? '0' + minutes : minutes;
                const secondsStr = seconds < 10 ? '0' + seconds : seconds;

                countdownElement.innerHTML = `${hoursStr}h ${minutesStr}m ${secondsStr}s`;
            }

            updateCountdown();
            const intervalId = setInterval(updateCountdown, 1000);
        }

        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date();
            const fajrTime = getTime(new Date(today), prayerTimes.fajr);
            const dhuhrTime = getTime(new Date(today), prayerTimes.dhuhr);
            const asrTime = getTime(new Date(today), prayerTimes.asr);
            const maghribTime = getTime(new Date(today), prayerTimes.maghrib);
            const ishaTime = getTime(new Date(today), prayerTimes.isha);

            const prayerTimesArray = [
                { name: 'Fajr', time: fajrTime },
                { name: 'Dhuhr', time: dhuhrTime },
                { name: 'Asr', time: asrTime },
                { name: 'Maghrib', time: maghribTime },
                { name: 'Isha', time: ishaTime }
            ];

            const nextPrayer = getNextPrayerTime(prayerTimesArray);
            document.getElementById('next-prayer').innerText = nextPrayer.name;
            document.getElementById('next-prayer-time').innerText = format12Hour(nextPrayer.time);
            startCountdown(nextPrayer);
        });
    </script>
</head>
<body>
    <h1>Next Prayer: <span id="next-prayer"></span> at <span id="next-prayer-time"></span></h1>
    <div id="countdown"></div>
</body>
</html>
